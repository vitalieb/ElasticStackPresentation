input {
  beats {
  port => 5044
  }
  tcp {
    port => 4560
    codec => json_lines
    add_field => {
      logger => logstash
    }
  }
}

filter {
  if [beat][name] == "filebeat_to_logstash_4" {
    grok {
      match => {
        message => "\[%{TIMESTAMP_ISO8601:@timestamp}\] %{LOGLEVEL:log.level} %{SPACE}%{USERNAME:log.package}%{SPACE}-%{SPACE}%{GREEDYDATA:message}"
      }
    }
  } else {
    mutate {
          rename => ["level", "log.level" ]
          rename => ["logger_name", "log.package" ]
      }
  }
}

output {
 if [beat][name] == "filebeat_to_logstash_4" {
  elasticsearch {
  hosts => ["http://localhost:9200"]
  index => "filebeat_logstash"
  }
  } else {
    elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "logback_logstash"
    }
  }
}